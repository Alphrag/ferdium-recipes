module.exports = Ferdi => class Outlook extends Ferdi {
  overrideUserAgent() {
    return window.navigator.userAgent.replace(/(Ferdi|Electron)\/\S+ \([^)]+\)/g, '').trim();
  }

  // https://docs.microsoft.com/en-us/microsoftteams/troubleshoot/teams-sign-in/sign-in-loop#resolution
  // https://docs.microsoft.com/en-us/microsoft-365/enterprise/urls-and-ip-address-ranges?view=o365-worldwide#microsoft-365-common-and-office-online
  knownCertificateHosts() {
    return [
      'accounts.google.com',
      'acompli.com',
      'acompli.helpshift.com',
      'acompli.net',
      'ad.atdmt.com',
      'ajax.aspnetcdn.com',
      'amp.azure.net',
      'api.dropboxapi.com',
      'api.login.yahoo.com',
      'api.meetup.com',
      'apis.live.net',
      'app.adjust.com',
      'app.box.com',
      'appex-rf.msn.com',
      'apps.identrust.com',
      'assets-yammer.com',
      'assets.onestore.ms',
      'auth.gfx.ms',
      'autologon.microsoftazuread-sso.com',
      'azure-apim.net',
      'azureedge.net',
      'bing.com',
      'bing.net',
      'bit.ly',
      'cdn.onenote.net',
      'cdn.optimizely.com',
      'cert.int-x3.letsencrypt.org',
      'cl2.apple.com',
      'clientconfig.microsoftonline-p.net',
      'cloudapp.net',
      'connect.facebook.net',
      'cortana.ai',
      'crl.globalsign.net',
      'crl.identrust.com',
      'd.docs.live.net',
      'data.flurry.com',
      'dc.services.visualstudio.com',
      'digicert.com',
      'docs.live.net',
      'dropbox.com',
      'edgesuite.net',
      'en-us.appex-rf.msn.com',
      'entrust.net',
      'evernote.com',
      'geotrust.com',
      'globalsign.com',
      'googleapis.com',
      'graph.facebook.com',
      'helpshift.com',
      'hockeyapp.net',
      'isrg.trustid.ocsp.identrust.com',
      'itunes.apple.com',
      'live.comlocalytics.com',
      'localytics.com',
      'login.microsoftonline-p.com',
      'login.windows-ppe.net',
      'm.facebook.com',
      'mail.google.com',
      'management.azure.com',
      'media.azure.net',
      'mem.gfx.ms',
      'microsoft.com',
      'microsoft.commicrosoft.com',
      'microsoftonline-p.com',
      'microsoftonline.com',
      'microsoftstream.com',
      'microsoftusercontent.com',
      'msauth.net',
      'msauthimages.net',
      'msecnd.net',
      'msedge.net',
      'msft.net',
      'msftauth.net',
      'msftauthimages.net',
      'msftidentity.com',
      'msidentity.com',
      'msocdn.com',
      'nexus.microsoftonline-p.com',
      'nps.onyx.azure.net',
      'o365weve.com',
      'oaspapps.com.akadns.net',
      'oaspapps.com',
      'ocsp.int-x3.letsencrypt.org',
      'ocsp.msocsp.com',
      'office.com',
      'office.net ',
      'office365.com',
      'office365servicehealthcommunications.cloudapp.net',
      'officeconfig.msocdn.com',
      'omniroot.com',
      'onedrive.com',
      'onenote.com',
      'outlook.com',
      'outlookmobile.com',
      'p100-sandbox.itunes.apple.com',
      'partnerservices.getmicrosoftkey.com',
      'phonefactor.net',
      'platform.linkedin.com',
      'play.google.com',
      'portal.cloudappsecurity.com',
      'powerapps.com',
      'prod.msocdn.com',
      'public-trust.com',
      'rink.hockeyapp.net',
      's.ytimg.com',
      's0.assets-yammer.com',
      'sdk.hockeyapp.net',
      'secure.aadcdn.microsoftonline-p.com',
      'secure.meetup.com',
      'sharepointonline.com',
      'shellprod.msocdn.com',
      'social.yahooapis.com',
      'staffhub.ms',
      'sway-cdn.com',
      'sway-extensions.com',
      'sway.com',
      'symcb.com',
      'symcd.com',
      'uservoice.com',
      'verisign.com',
      'verisign.net',
      'view.atdmt.com',
      'virtualearth.net',
      'windows.com',
      'windows.net',
      'windowsazure.com',
      'yammer.com',
      'yammerusercontent.com',
      'youtube.com',
    ];
  };
};
